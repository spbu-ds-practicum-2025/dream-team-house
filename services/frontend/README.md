# Frontend

## Описание

Stateless веб-приложение на Next.js 15, обеспечивающее пользовательский интерфейс для работы с распределённой системой коллективного редактирования документов.

## Технологии

- Next.js 15
- React 18
- TypeScript 5
- TailwindCSS 3
- Recharts 2
- Docker

## Архитектура

- Работает в контейнере Docker на порту 3000
- Все запросы к Backend через Load Balancer
- Polling для обновления данных (без WebSocket)
- Адаптивный дизайн с поддержкой тёмной темы

## Страницы

### 1. Главная страница `/`
Форма инициализации нового документа:
- Поле "Тема документа"
- Поле "Начальный текст"
- Кнопка "Начать работу"
- После отправки: запрос `POST /api/document/init`

### 2. Просмотр документа `/document`
Отображение текущего состояния документа:
- Текст документа с версионностью
- Подсветка недавно изменённых фрагментов
- Автообновление каждые 2 секунды (`GET /api/document/current`)
- Отображение текущей версии и timestamp

### 3. История правок `/edits`
Табличное представление всех правок:
- Столбцы: ID правки, агент, статус, токены, время
- Пагинация (limit/offset)
- Запрос: `GET /api/edits?limit=<number>&offset=<number>`
- Фильтрация по статусу (принято/отклонено)

### 4. Чат агентов `/chat`
Лента информационных сообщений:
- Отображение агента и текста сообщения
- Автообновление каждые 3 секунды
- Запрос: `GET /api/chat/messages?since=<last_timestamp>`
- Автопрокрутка к новым сообщениям

### 5. Аналитика `/analytics`
Дашборд с интерактивными графиками:
- Линейный график: правки во времени
- Bar chart: потребление токенов по минутам
- Числовые метрики: активные агенты, средняя задержка
- Селектор периода: 1h / 24h / 7d
- Запрос: `GET /api/analytics/metrics?period=<period>`
- Библиотека: Recharts

## Взаимодействие с Backend

Все HTTP-запросы через Load Balancer:
```typescript
const API_BASE = 'http://load-balancer/api';

// Пример использования fetch API
const response = await fetch(`${API_BASE}/document/current`);
const data = await response.json();
```

## Стилизация

- **TailwindCSS** для быстрого прототипирования
- Адаптивный дизайн (mobile-first подход)
- Тёмная и светлая темы
- Консистентная цветовая схема
- Анимации переходов для улучшения UX

## Особенности реализации

### Polling вместо WebSocket
- Документ: обновление каждые 2 секунды
- Чат: обновление каждые 3 секунды
- Аналитика: обновление по запросу пользователя

### Обработка ошибок
- Отображение уведомлений об ошибках сети
- Retry логика для критичных запросов
- Fallback для недоступных сервисов

### Оптимизация производительности
- React.memo для предотвращения лишних рендеров
- Дебаунсинг для поисковых полей
- Виртуализация для длинных списков правок
- Кэширование запросов через SWR или React Query

## Требования

- Node.js 20+
- npm или yarn
- Docker для контейнеризации
